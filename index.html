<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>DeepHex Beta</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
      /* Fill the whole window and keep black borders */
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #000;
      }

      /* Phaser container fills the screen and acts as positioning context */
      #game-container {
        position: relative;       /* positioning context for children */
        width: 100%;
        height: 100%;
        background: #000;
        -webkit-tap-highlight-color: transparent;
      }

      /* Canvas and DOM overlay must fully overlap the same rect */
      #game-container > canvas,
      #game-container > .dom-container {
        position: absolute;
        inset: 0;                 /* top/right/bottom/left = 0 */
        display: block;
      }

      /* Ensure DOM overlay renders above the canvas and receives input */
      #game-container > canvas { z-index: 0; }
      #game-container > .dom-container { z-index: 10; pointer-events: auto; }

      /* Keep scaling crisp */
      #game-container > canvas { image-rendering: pixelated; }

      /* Optional: hide scrollbars just in case */
      ::-webkit-scrollbar { display: none; }
    </style>
  </head>

  <body>
    <div id="game-container"></div>

    <!-- Phaser (use your current build or CDN if local is not bundled) -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>

    <script type="module">
      import LobbyScene from "./src/scenes/LobbyScene.js";
      import WorldScene from "./src/scenes/WorldScene.js";
      import CombatScene from "./src/scenes/CombatScene.js";

      const DESIGN_WIDTH = 1600;
      const DESIGN_HEIGHT = 1000;

      const config = {
        type: Phaser.AUTO,
        backgroundColor: "#000000",
        parent: "game-container",
        scene: [LobbyScene, WorldScene, CombatScene],
        scale: {
          mode: Phaser.Scale.FIT,                // Fit canvas to any window
          autoCenter: Phaser.Scale.CENTER_BOTH,  // Center horizontally + vertically
          width: DESIGN_WIDTH,
          height: DESIGN_HEIGHT
        },
        resolution: window.devicePixelRatio || 1, // Crisp on high-DPI
        render: {
          antialias: true,
          roundPixels: true,
          pixelArt: false
        },
        dom: { createContainer: true }           // Create Phaser DOM overlay
      };

      const game = new Phaser.Game(config);

      // Optional: nudge Scale Manager after resizes (helps some browsers)
      window.addEventListener("resize", () => {
        if (game && game.scale) game.scale.refresh();
      });
    </script>
  </body>
</html>
